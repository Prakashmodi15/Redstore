<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All Products - RedStore</title>
  <link rel="stylesheet" href="CSS/style.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>

  <!-- NAVBAR -->
  <div class="container">
    <div class="navbar">
      <div class="logo">
        <a href="/index.html"><img src="/images/logo.png" width="125px" alt="RedStore Logo"></a>
      </div>
      <nav>
        <ul id="MenuItems">
          <li><a href="/index.html">Home</a></li>
          <li><a href="/products.html" class="active">Products</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/contact.html">Contact</a></li>
          <li><a href="/account.html">Account</a></li>
        </ul>
      </nav>
      <img src="/images/cart.png" width="30" alt="Cart">
      <img src="/images/menu.png" class="menu-icon" onclick="menutoggle()">
    </div>
  </div>

  <!-- PRODUCTS -->
  <div class="small container">
    <div class="row row-2">
      <h2>All Products</h2>
      <select id="sort">
        <option value="default">Default Sorting</option>
        <option value="price">Sort by Price</option>
        <option value="latest">Sort by Latest</option>
      </select>
    </div>

    <div class="row" id="product-list"></div>
  </div>

  <!-- FOOTER -->
  <div class="footer">
    <div class="container">
      <hr>
      <p class="copyright">Copyright 2025 - Made with ‚ù§Ô∏è by Prakash Modi</p>
    </div>
  </div>

  <!-- MENU TOGGLE SCRIPT -->
  <script>
    var MenuItems = document.getElementById("MenuItems");
    MenuItems.style.maxHeight = "0px";
    function menutoggle() {
      MenuItems.style.maxHeight = MenuItems.style.maxHeight === "0px" ? "200px" : "0px";
    }
  </script>

  <!-- FIREBASE PRODUCTS SCRIPT -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import {
      getFirestore, collection, onSnapshot, query, orderBy
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // üîπ Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyBe6T75YFS3MACQ1Drmrrj6xeRlMIwT7s4",
      authDomain: "myshop-1dbc9.firebaseapp.com",
      projectId: "myshop-1dbc9",
      storageBucket: "myshop-1dbc9.appspot.com",
      messagingSenderId: "81466489688",
      appId: "1:81466489688:web:e225da8670b2314dd1432d"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const productList = document.getElementById("product-list");
    const sort = document.getElementById("sort");

    // üîπ Load Products Function
    function loadProducts(q) {
      onSnapshot(q, snap => {
        productList.innerHTML = "";
        if (snap.empty) {
          productList.innerHTML = "<p>No products found!</p>";
        }
        snap.forEach(doc => {
          const p = doc.data();
          productList.innerHTML += `
            <div class="col-4">
              <a href="/product-detail.html?id=${doc.id}">
                <img src="${p.image}" alt="${p.name}">
                <h4>${p.name}</h4>
              </a>
              <p>‚Çπ${p.price}</p>
            </div>
          `;
        });
      }, err => console.error("Firebase error:", err));
    }

    // üîπ Default load
    loadProducts(collection(db, "products"));

    // üîπ Sorting
    sort.onchange = () => {
      if (sort.value === "price") {
        loadProducts(query(collection(db, "products"), orderBy("price", "asc")));
      } else if (sort.value === "latest") {
        loadProducts(query(collection(db, "products"), orderBy("createdAt", "desc")));
      } else {
        loadProducts(collection(db, "products"));
      }
    };
  </script>

</body>
</html>
