<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Manage Products</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#f2f2f2}
.box{max-width:900px;margin:30px auto;background:#fff;padding:20px}
.item{display:flex;align-items:center;gap:15px;border-bottom:1px solid #ddd;padding:10px 0}
.item img{width:70px;height:70px;object-fit:cover}
input{width:80px;padding:5px}
button{background:#ff523b;color:#fff;border:none;padding:6px 10px;cursor:pointer}
</style>
</head>
<body>

<div class="box">
<h2>Manage Products</h2>
<div id="list"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, onSnapshot, deleteDoc, doc, updateDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { getStorage, ref, deleteObject }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyBe6T75YFS3MACQ1Drmrrj6xeRlMIwT7s4",
  authDomain: "myshop-1dbc9.firebaseapp.com",
  projectId: "myshop-1dbc9",
  storageBucket: "myshop-1dbc9.appspot.com",
  messagingSenderId: "81466489688",
  appId: "1:81466489688:web:e225da8670b2314dd1432d"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);
const list = document.getElementById("list");

onSnapshot(collection(db,"products"),snap=>{
  list.innerHTML="";
  snap.forEach(d=>{
    const p=d.data();
    list.innerHTML+=`
      <div class="item">
        <img src="${p.image}">
        <input value="${p.name}" id="n${d.id}">
        <input value="${p.price}" id="p${d.id}">
        <button onclick="save('${d.id}')">Save</button>
        <button onclick="del('${d.id}','${p.image}')">Delete</button>
      </div>
    `;
  });
});

window.save = async(id)=>{
  const name=document.getElementById("n"+id).value;
  const price=document.getElementById("p"+id).value;
  await updateDoc(doc(db,"products",id),{name,price});
  alert("Updated âœ…");
}

window.del = async(id,img)=>{
  if(!confirm("Delete product?")) return;
  await deleteDoc(doc(db,"products",id));
  await deleteObject(ref(storage,img));
}
</script>

</body>
</html>
