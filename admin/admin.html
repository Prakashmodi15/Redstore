<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RedStore Admin Panel</title>
<link rel="stylesheet" href="CSS/style.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>

<!-- Header Settings -->
<div class="header">
  <div class="container">
    <div class="row">
      <div class="col-2">
        <h3>Header Settings</h3>
        <input type="text" id="headerTitle" placeholder="Header Title" style="width:100%; margin-bottom:10px;">
        <input type="text" id="headerImg" placeholder="Header Image URL" style="width:100%; margin-bottom:10px;">
        <button onclick="saveHeader()" style="padding:10px 20px;">Save Header</button>
      </div>
      <div class="col-2">
        <img id="headerPreview" src="images/image1.png" alt="header image" style="width:100%;">
      </div>
    </div>
  </div>
</div>

<!-- Offer Settings -->
<div class="small container" style="margin-top:30px;">
  <h3>Offer Settings</h3>
  <input type="text" id="offerImg" placeholder="Offer Image URL" style="width:100%; margin-bottom:10px;">
  <input type="text" id="offerTitle" placeholder="Offer Title" style="width:100%; margin-bottom:10px;">
  <textarea id="offerDesc" placeholder="Offer Description" style="width:100%; height:60px; margin-bottom:10px;"></textarea>
  <button onclick="saveOffer()" style="padding:10px 20px;">Save Offer</button>
</div>

<!-- Latest Products Settings -->
<div class="small container" style="margin-top:30px;">
  <h3>Latest Products</h3>
  <div class="row" id="latestProducts"></div>
  <button onclick="saveProducts()" style="margin-top:10px; padding:10px 20px;">Save Latest Products</button>
</div>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyBe6T75YFS3MACQ1Drmrrj6xeRlMIwT7s4",
  authDomain: "myshop-1dbc9.firebaseapp.com",
  projectId: "myshop-1dbc9",
  storageBucket: "myshop-1dbc9.appspot.com",
  messagingSenderId: "81466489688",
  appId: "1:81466489688:web:e225da8670b2314dd1432d"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Header Save
function saveHeader(){
  const title = document.getElementById('headerTitle').value;
  const img = document.getElementById('headerImg').value;

  if(!title || !img){ alert("Please fill all header fields!"); return; }

  db.collection("admin").doc("header").set({headerTitle:title, headerImg:img})
  .then(()=>{
    alert("Header Saved Successfully!");
    document.getElementById('headerPreview').src = img;
  })
  .catch(err=>{
    console.error(err);
    alert("Error saving header!");
  });
}

// Offer Save
function saveOffer(){
  const img = document.getElementById('offerImg').value;
  const title = document.getElementById('offerTitle').value;
  const desc = document.getElementById('offerDesc').value;

  if(!img || !title || !desc){ alert("Please fill all offer fields!"); return; }

  db.collection("admin").doc("offer").set({offerImg:img, offerTitle:title, offerDesc:desc})
  .then(()=>{ alert("Offer Saved Successfully!"); })
  .catch(err=>{
    console.error(err);
    alert("Error saving offer!");
  });
}

// Latest Products Sample
const sampleProducts = [
  {img:"images/product-5.jpg", name:"Red Printed T-shirt", price:"$50.00"},
  {img:"images/product-6.jpg", name:"Red Printed T-shirt", price:"$50.00"},
  {img:"images/product-7.jpg", name:"Red Printed T-shirt", price:"$50.00"},
  {img:"images/product-8.jpg", name:"Red Printed T-shirt", price:"$50.00"}
];

// Load Products
function loadProducts(){
  const container = document.getElementById('latestProducts');
  container.innerHTML = '';
  sampleProducts.forEach(p=>{
    container.innerHTML += `
      <div class="col-4">
        <input type="text" class="prodName" value="${p.name}" placeholder="Product Name" style="width:100%; margin-bottom:5px;">
        <input type="text" class="prodImg" value="${p.img}" placeholder="Image URL" style="width:100%; margin-bottom:5px;">
        <input type="text" class="prodPrice" value="${p.price}" placeholder="Price" style="width:100%; margin-bottom:5px;">
        <img src="${p.img}" style="width:100px; margin-top:5px;">
      </div>
    `;
  });
}

// Save Products
function saveProducts(){
  const container = document.getElementById('latestProducts');
  const products = [];
  container.querySelectorAll('.col-4').forEach(col=>{
    const name = col.querySelector('.prodName').value;
    const img = col.querySelector('.prodImg').value;
    const price = col.querySelector('.prodPrice').value;
    if(name && img && price) products.push({name,img,price});
  });

  if(products.length === 0){ alert("No products to save!"); return; }

  db.collection("admin").doc("latestProducts").set({items:products})
  .then(()=>{ alert("Latest Products Saved Successfully!"); })
  .catch(err=>{
    console.error(err);
    alert("Error saving latest products!");
  });
}

// Load on page load
loadProducts();
</script>

</body>
</html>
